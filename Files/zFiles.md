# PixelFruit 项目文件功能说明

## 核心功能模块

### Basic.js - 基础工具模块
- **功能**: 提供图像处理的基础工具函数
- **主要特性**:
  - 防抖函数 (debounce) - 延迟执行函数调用，避免频繁触发
  - 文件读取工具 (readFileAsArrayBuffer) - 异步读取文件为ArrayBuffer
  - 图像缓存更新 (updateImageFromCache) - 从缓存更新图像显示
- **用途**: 为其他模块提供基础工具函数支持

### color.js - 颜色调整模块
- **功能**: 处理所有颜色相关的调整功能
- **主要特性**:
  - 白平衡调整 (自动/相机白平衡)
  - 基础颜色调整 (亮度、曝光、饱和度、对比度)
  - 高级颜色调整 (色调、高光、阴影、白色)
  - 颜色调整事件监听器管理
- **用途**: 提供完整的颜色调整功能，支持实时预览

### Details.js - 细节处理模块
- **功能**: 图像细节处理和质量优化
- **主要特性**:
  - 锐化处理 (非锐化蒙版算法)
  - 降噪处理 (均值、中值、高斯滤波)
  - 纹理/清晰度调整
  - 细节保留控制
  - **面部美白算法** (智能肤色检测与美白处理)
- **用途**: 提升图像细节和清晰度，减少噪点，专业人像美白处理

### exportImage.js - 图像导出模块
- **功能**: 处理图像导出为不同格式
- **主要特性**:
  - PNG格式导出 (无损压缩)
  - JPEG格式导出 (可调质量)
  - 自动文件命名
  - 导出进度反馈
- **用途**: 将处理后的图像导出为常见格式

### ImageProcessor.js - 图像处理器
- **功能**: 高性能图像处理核心引擎
- **主要特性**:
  - Web Worker多线程处理
  - 任务队列管理
  - 结果缓存系统
  - 并发操作控制
- **用途**: 提供高性能的图像处理能力，避免主线程阻塞

### HistogramManager.js - 直方图管理器
- **功能**: 直方图计算和显示优化
- **主要特性**:
  - 亮度直方图计算
  - RGB通道直方图
  - 性能优化缓存
  - 防抖更新机制
- **用途**: 实时显示图像色彩分布，辅助调色

### SliderManager.js - 滑块管理器
- **功能**: 统一管理所有滑块控件
- **主要特性**:
  - 批量事件监听器注册
  - 防抖处理优化
  - 内存泄漏防护
  - 性能监控
- **用途**: 优化滑块交互性能，统一管理用户界面控件

## 高级功能模块

### PerformanceOptimizer.js - 性能优化器
- **功能**: 综合性能优化系统
- **主要特性**:
  - 多级缓存系统 (图像数据、处理结果、操作序列)
  - 智能缓存失效机制
  - 内存使用监控
  - 渲染策略优化
- **用途**: 全面提升应用性能，减少重复计算

### Filter.js - 滤镜管理模块
- **功能**: 滤镜预设管理和应用
- **主要特性**:
  - 预设滤镜库 (万能公式、富士色彩、复古胶片、复古钟楼、球场电影感、人像滤镜、黑白模式)
  - 自定义滤镜保存/加载
  - 滤镜参数批量应用
  - 滤镜历史记录
  - **人像滤镜** (专业人像处理，包含美白、柔肤、增强对比度)
- **用途**: 提供一键式滤镜效果，快速调色，特别优化人像处理

### Chart.js - 图表管理模块
- **功能**: 图表显示和管理
- **主要特性**:
  - 直方图显示控制
  - 图表模式切换 (亮度/RGB)
  - 图表更新优化
  - 用户交互处理
- **用途**: 管理所有图表相关功能，提供数据可视化

### Replacecolor.js - 颜色替换模块
- **功能**: 高级颜色替换和调整
- **主要特性**:
  - 颜色范围选择 (双滑块控制)
  - 目标颜色设置
  - 颜色容差控制
  - 替换历史管理
  - 实时预览功能
- **用途**: 精确控制特定颜色范围的替换，支持复杂调色需求

## 算法技术详解

### 面部美白算法 (Details.js)
- **肤色检测算法**:
  - RGB范围检测: `r > 80 && g > 30 && b > 15`
  - YUV色彩空间检测: 基于亮度、色度范围判断
  - 归一化RGB检测: 基于颜色比例判断
  - 简单肤色范围检测: `r > g && g > b && r - b > 20`
- **美白处理算法**:
  - 亮度提升: 最大增加30%亮度
  - 红色减少: 最大减少20%红色分量，去黄调
  - 蓝色增加: 最大增加15%蓝色分量，增加冷调
  - 饱和度降低: 最大减少40%饱和度，接近白色
- **平滑处理**: 高斯模糊处理蒙版，避免生硬边界

### 降噪算法 (Details.js)
- **均值滤波**: 3x3邻域平均，保留细节
- **中值滤波**: 椒盐噪声处理，保持边缘
- **高斯滤波**: 平滑降噪，权重分布
- **细节保留**: 基于边缘检测的保护机制

### 锐化算法 (Details.js)
- **非锐化蒙版**: 基于拉普拉斯算子的锐化
- **纹理增强**: 可调节的清晰度控制
- **边缘保护**: 避免过度锐化产生伪影

### 滤镜系统架构 (Filter.js)
- **参数映射**: 自动映射所有调整参数
- **批量应用**: 一次性应用复杂调色方案
- **预设管理**: 7种专业滤镜预设
- **自定义保存**: 保存个人调色方案

 ## 版本更新记录

### v1.2.0 - 人像处理增强版
- ✨ **Details.js**: 新增面部美白算法，智能肤色检测与美白处理
- ✨ **Filter.js**: 新增人像滤镜，专业人像处理预设
- 🔧 **Details.js**: 优化降噪和锐化算法
- 🎨 **Filter.js**: 扩展滤镜系统，支持更多自定义参数

### v1.0.0 - 正式版发布
- 🔧 **整体架构**: 功能模块化重构
- 🔧 **Details.js**: 实现多种降噪算法
- 🧹 **代码清理**: 删除无用代码
- ⚡ **性能优化**: 提升整体流畅度
- 🔍 **图片细节**: 新增像素级细节查看功能

### beta1.0 - 功能完善版
- ✅ **基础功能**: RAW格式支持、调色、滤镜、直方图
- ✅ **模块化**: 各功能模块独立开发
- ✅ **初始发布**: 项目基础功能完成
