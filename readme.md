# PixelFruit - 专业RAW图像处理工具

基于 LibRaw-Wasm 开发的高性能在线 RAW 格式图片处理工具，为摄影爱好者和专业用户提供完整的RAW文件编辑解决方案。

## 🚀 核心功能

- ✅ **原生RAW支持** - 完整支持主流相机RAW格式解析与处理
- ✅ **实时预览** - 所见即所得的实时图像调整效果
- ✅ **专业调色** - 完整的颜色调整工具集（亮度、对比度、饱和度、色调等）
- ✅ **细节处理** - 高级锐化、降噪和纹理处理算法
- ✅ **面部美白** - 智能肤色检测与美白处理，让人像更美丽
- ✅ **颜色替换** - 精确的颜色范围选择和替换功能
- ✅ **滤镜系统** - 丰富的预设滤镜和自定义滤镜支持（包含专业人像滤镜）
- ✅ **直方图分析** - 实时直方图显示，辅助专业调色
- ✅ **高性能处理** - Web Worker多线程处理，流畅的用户体验
- ✅ **多格式导出** - 支持PNG、JPEG等主流格式导出

## 📷 支持的相机格式

### 完全支持
- **索尼 (Sony)** - ARW 格式
- **佳能 (Canon)** - CR2 格式  
- **尼康 (Nikon)** - NEF 格式 (有问题驱动没看到不支持新的尼康相机)
- **富士 (Fuji)** - RAF 格式
- **松下 (Panasonic)** - RW2 格式
- **奥林巴斯 (Olympus)** - ORF 格式
- **宾得 (Pentax)** - DNG 格式
- **通用格式** - DNG 格式 (dng少量支持 手机的大部分不支持)

### 技术特性
- 支持12-16位色深处理
- 完整的元数据保留
- 白平衡信息读取
- 相机设置参数解析

## 🎯 使用指南

### 快速开始
1. **上传RAW文件** - 拖拽或点击选择你的RAW格式图片
2. **基础调整** - 使用左侧面板调整亮度、曝光、饱和度等基础参数
3. **高级调色** - 在右侧面板进行精细的颜色调整和细节处理
4. **滤镜应用** - 选择预设滤镜或创建自定义滤镜效果
5. **导出图片** - 选择PNG或JPEG格式导出最终结果

### 专业功能
- **颜色替换** - 精确选择颜色范围进行替换
- **直方图分析** - 实时查看图像色彩分布
- **细节处理** - 锐化和降噪处理
- **面部美白** - 智能肤色检测，自动美白人像
- **滤镜系统** - 内置多种专业滤镜（万能公式、富士色彩、复古胶片、人像等）
- **历史记录** - 保存和恢复处理步骤

## ✨ 特色功能

### 🎭 面部美白技术
- **智能肤色检测** - 基于RGB、YUV、归一化RGB多重算法
- **自然美白效果** - 增加亮度、减少黄调、增加冷调
- **平滑过渡** - 高斯模糊处理，避免生硬边界
- **实时预览** - 所见即所得的美白效果

### 🎨 专业滤镜系统
- **万能公式** - 通用调色方案，适合大多数场景
- **富士色彩** - 模拟富士胶片色彩风格
- **复古胶片** - 经典胶片色调效果
- **复古钟楼** - 怀旧建筑摄影风格
- **球场电影感** - 运动场景电影级调色
- **人像滤镜** - 专业人像处理，包含美白、柔肤、增强对比度
- **黑白模式** - 经典黑白摄影效果
- **自定义滤镜** - 保存个人调色方案

### 🔧 细节处理算法
- **多算法降噪** - 均值滤波、中值滤波、高斯滤波
- **智能锐化** - 非锐化蒙版技术
- **细节保留** - 边缘保护，避免过度处理
- **纹理增强** - 可调节的纹理清晰度
- **面部美白** - 智能肤色检测与美白算法

### 🎨 滤镜系统架构
- **预设滤镜** - 7种专业滤镜预设
- **自定义滤镜** - 保存个人调色方案
- **参数扩展** - 支持所有调整参数
- **实时预览** - 即时查看滤镜效果
- **一键应用** - 快速应用复杂调色方案

## 🛠️ 技术架构

### 核心技术栈
- **LibRaw-Wasm** - RAW格式解析核心
- **Web Workers** - 多线程图像处理
- **Canvas API** - 图像渲染和操作
- **ES6 Modules** - 模块化架构设计

### 性能优化
- **智能缓存系统** - 多级缓存减少重复计算
- **防抖处理** - 优化用户交互响应
- **渐进式渲染** - 大图像分块处理
- **内存管理** - 自动垃圾回收和内存优化
- **Web Worker** - 多线程处理，避免UI阻塞

### 算法特性
- **肤色检测算法** - RGB+YUV+归一化RGB多重检测
- **美白算法** - 亮度提升+色温调整+饱和度控制
- **降噪算法** - 三种滤波算法可选
- **锐化算法** - 非锐化蒙版技术
- **颜色空间转换** - 支持多种色彩空间处理

## 📁 项目结构

### 核心文件
```
pixelFruit/
├── index.html          # 主页面入口
├── index.js           # 应用主逻辑
├── css/index.css      # 样式文件
├── libraw.js          # LibRaw WebAssembly接口
├── libraw.wasm        # LibRaw WebAssembly二进制
└── worker.js          # Web Worker处理脚本
```

### Files/ 模块目录
```
Files/
├── Basic.js              # 基础工具函数
├── color.js              # 颜色调整模块
├── Details.js            # 细节处理模块（包含面部美白算法）
├── exportImage.js        # 图像导出模块
├── ImageProcessor.js     # 图像处理器
├── HistogramManager.js   # 直方图管理器
├── SliderManager.js      # 滑块管理器
├── PerformanceOptimizer.js # 性能优化器
├── Filter.js             # 滤镜管理模块（包含人像滤镜）
├── Chart.js              # 图表管理模块
├── Replacecolor.js       # 颜色替换模块
└── zFiles.md            # 文件功能说明
```

### 构建文件
```
├── libraw_wrapper.cpp    # C++包装代码
├── compileLibraw.sh      # 编译脚本
├── makefile             # 构建配置
├── libs/                # 编译库文件
└── includes/            # 头文件目录
```

## 🚀 快速开始

### 本地运行
1. 克隆项目到本地
2. 使用 Live Server 或类似工具启动本地服务器
3. 在浏览器中访问 `http://localhost:5500`

### 在线使用
直接访问项目页面，无需安装任何软件

## 💡 使用技巧

### 🎭 人像处理技巧
- **面部美白** - 建议强度30-60，平滑度50-80
- **人像滤镜** - 一键应用专业人像调色方案
- **细节处理** - 先降噪再锐化，效果更自然
- **色彩调整** - 减少红色增加蓝色，肤色更白皙

### 🎨 滤镜使用建议
- **万能公式** - 适合大多数场景的通用调色
- **富士色彩** - 适合风景和街拍
- **复古胶片** - 适合怀旧风格照片
- **人像滤镜** - 专门优化人像照片
- **自定义滤镜** - 保存个人常用调色方案



## 📄 许可证

⚠️ **使用条款**
- 本项目仅供个人学习和非商业使用
- 禁止用于任何商业用途
- 基于 LibRaw-Wasm 开源协议

**原始项目**: [LibRaw-Wasm](https://github.com/ybouane/LibRaw-Wasm)

## 🤝 贡献指南

欢迎参与项目改进：
- 提交 Issue 报告问题
- 提交 PR 贡献代码
- 分享使用体验和建议

## 📝 更新日志

### v1.2.0 - 人像处理增强版
- 🎨 **重构UI界面** - 优化用户界面布局和交互体验
- ✨ **新增面部美白功能** - 智能肤色检测与美白处理
- ✨ **新增人像滤镜** - 专业人像处理预设
- 🔧 **优化细节处理** - 增强锐化和降噪算法
- 🎨 **扩展滤镜系统** - 支持更多自定义参数
- 🐛 **修复图片细节面板** - 确保实时更新显示

### v1.0.0 - 正式版发布
- 🔧 **功能模块化** - 代码重构，功能抽离为独立模块
- 🔧 **降噪算法优化** - 实现多种降噪算法（均值、中值、高斯滤波）
- 🧹 **代码清理** - 删除无用代码，提升代码质量
- ⚡ **性能优化** - 提升整体流畅度和响应速度
- 🔍 **图片细节查看** - 新增像素级细节查看功能
- 🎨 **色彩一致性** - 修复颜色导出不一致问题
- 🗑️ **功能精简** - 删除透视矫正功能，专注核心功能

### beta1.0 - 功能完善版
- ✅ **RAW格式支持** - 完整支持主流相机RAW格式
- ✅ **基础调色功能** - 亮度、对比度、饱和度等基础调整
- ✅ **滤镜系统** - 预设滤镜和自定义滤镜支持
- ✅ **直方图分析** - 实时直方图显示和分析
- ✅ **初始版本发布** - 项目基础功能完成

## 📞 联系方式

- **项目地址**: [GitHub Repository]
- **问题反馈**: 通过 Issues 提交
- **功能建议**: 欢迎在 Issues 中讨论
